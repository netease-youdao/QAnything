import{r as e,a2 as t,c as a,I as l,a3 as r,a4 as o,a5 as s,a6 as n,a7 as i,a8 as c,a9 as u,aa as d,d as p,a as v,_ as g,h as f,J as m,ab as y,i as h,g as k,m as b,ac as C,ad as w,u as x,ae as S,af as A,ag as $,ah as I,Y as O,o as _,V as j,k as z,B as D,A as E,j as F,w as N,x as L,q as T,v as P,n as M,K as W,U as R,z as U,l as V,y as q,E as B,$ as X,L as K,T as Q,M as Z,ai as H,Q as J,R as Y,e as G,S as ee,aj as te,ak as ae,C as le,D as re,a1 as oe,W as se}from"./index-CyT_JrVy.js";import{r as ne,u as ie,d as ce,a as ue,b as de}from"./utils-BzG5gSak.js";import{_ as pe,b as ve,a as ge,u as fe,c as me,p as ye}from"./useUploadFiles-CYaJxLSn.js";import{g as he}from"./index-ijqAf8GC.js";import{C as ke}from"./CheckOutlined-DTpRR-NY.js";import{_ as be}from"./index-Cm96pFaw.js";import{u as Ce}from"./useChatSetting-DM_T8Wuf.js";import{u as we,_ as xe,M as Se}from"./useChatSource-fedLYmbz.js";import{S as Ae}from"./index-Be05oWUQ.js";import{L as $e}from"./ChatInfoPanel-DEYYRASb.js";import{_ as Ie,T as Oe,a as _e}from"./index-Dm5kKtlD.js";import{_ as je}from"./ActionButton-Cm0KQ8no.js";import{I as ze}from"./index-CCunlmY6.js";var De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"};function Ee(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),l.forEach((function(t){Fe(e,t,a[t])}))}return e}function Fe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ne=function(e,t){var r=Ee({},e,t.attrs);return a(l,Ee({},r,{icon:De}),null)};Ne.displayName="PlusOutlined",Ne.inheritAttrs=!1;const Le=["normal","exception","active","success"],Te=()=>({prefixCls:String,type:r(),percent:Number,format:o(),status:r(),showInfo:s(),strokeWidth:Number,strokeLinecap:r(),strokeColor:n(),trailColor:String,width:Number,success:i(),gapDegree:Number,gapPosition:r(),size:c([String,Number,Array]),steps:Number,successPercent:Number,title:String,progressStatus:r()});function Pe(e){return!e||e<0?0:e>100?100:e}function Me(e){let{success:t,successPercent:a}=e,l=a;return t&&"progress"in t&&(u(!1,"Progress","`success.progress` is deprecated. Please use `success.percent` instead."),l=t.progress),t&&"percent"in t&&(l=t.percent),l}const We=(e,t,a)=>{var l,r,o,s;let n=-1,i=-1;if("step"===t){const t=a.steps,l=a.strokeWidth;"string"==typeof e||void 0===e?(n="small"===e?2:14,i=null!=l?l:8):"number"==typeof e?[n,i]=[e,e]:[n=14,i=8]=e,n*=t}else if("line"===t){const t=null==a?void 0:a.strokeWidth;"string"==typeof e||void 0===e?i=t||("small"===e?6:8):"number"==typeof e?[n,i]=[e,e]:[n=-1,i=8]=e}else"circle"!==t&&"dashboard"!==t||("string"==typeof e||void 0===e?[n,i]="small"===e?[60,60]:[120,120]:"number"==typeof e?[n,i]=[e,e]:(n=null!==(r=null!==(l=e[0])&&void 0!==l?l:e[1])&&void 0!==r?r:120,i=null!==(s=null!==(o=e[0])&&void 0!==o?o:e[1])&&void 0!==s?s:120));return{width:n,height:i}};const Re=(e,t)=>{const{from:a=d.blue,to:l=d.blue,direction:r=("rtl"===t?"to left":"to right")}=e,o=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(l=Object.getOwnPropertySymbols(e);r<l.length;r++)t.indexOf(l[r])<0&&Object.prototype.propertyIsEnumerable.call(e,l[r])&&(a[l[r]]=e[l[r]])}return a}(e,["from","to","direction"]);if(0!==Object.keys(o).length){return{backgroundImage:`linear-gradient(${r}, ${(e=>{let t=[];return Object.keys(e).forEach((a=>{const l=parseFloat(a.replace(/%/g,""));isNaN(l)||t.push({key:l,value:e[a]})})),t=t.sort(((e,t)=>e.key-t.key)),t.map((e=>{let{key:t,value:a}=e;return`${a} ${t}%`})).join(", ")})(o)})`}}return{backgroundImage:`linear-gradient(${r}, ${a}, ${l})`}},Ue=p({compatConfig:{MODE:3},name:"ProgressLine",inheritAttrs:!1,props:g(g({},Te()),{strokeColor:n(),direction:r()}),setup(e,t){let{slots:l,attrs:r}=t;const o=v((()=>{const{strokeColor:t,direction:a}=e;return t&&"string"!=typeof t?Re(t,a):{backgroundColor:t}})),s=v((()=>"square"===e.strokeLinecap||"butt"===e.strokeLinecap?0:void 0)),n=v((()=>e.trailColor?{backgroundColor:e.trailColor}:void 0)),i=v((()=>{var t;return null!==(t=e.size)&&void 0!==t?t:[-1,e.strokeWidth||("small"===e.size?6:8)]})),c=v((()=>We(i.value,"line",{strokeWidth:e.strokeWidth}))),u=v((()=>{const{percent:t}=e;return g({width:`${Pe(t)}%`,height:`${c.value.height}px`,borderRadius:s.value},o.value)})),d=v((()=>Me(e))),p=v((()=>{const{success:t}=e;return{width:`${Pe(d.value)}%`,height:`${c.value.height}px`,borderRadius:s.value,backgroundColor:null==t?void 0:t.strokeColor}})),y={width:c.value.width<0?"100%":c.value.width,height:`${c.value.height}px`};return()=>{var t;return a(m,null,[a("div",f(f({},r),{},{class:[`${e.prefixCls}-outer`,r.class],style:[r.style,y]}),[a("div",{class:`${e.prefixCls}-inner`,style:n.value},[a("div",{class:`${e.prefixCls}-bg`,style:u.value},null),void 0!==d.value?a("div",{class:`${e.prefixCls}-success-bg`,style:p.value},null):null])]),null===(t=l.default)||void 0===t?void 0:t.call(l)])}}});let Ve=0;function qe(e){return+e.replace("%","")}function Be(e){return Array.isArray(e)?e:[e]}function Xe(e,t,a,l){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const o=50-l/2;let s=0,n=-o,i=0,c=-2*o;switch(arguments.length>5?arguments[5]:void 0){case"left":s=-o,n=0,i=2*o,c=0;break;case"right":s=o,n=0,i=-2*o,c=0;break;case"bottom":n=o,c=2*o}const u=`M 50,50 m ${s},${n}\n   a ${o},${o} 0 1 1 ${i},${-c}\n   a ${o},${o} 0 1 1 ${-i},${c}`,d=2*Math.PI*o;return{pathString:u,pathStyle:{stroke:a,strokeDasharray:`${t/100*(d-r)}px ${d}px`,strokeDashoffset:`-${r/2+e/100*(d-r)}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s"}}}const Ke=p({compatConfig:{MODE:3},name:"VCCircle",props:h({gapDegree:Number,gapPosition:{type:String},percent:{type:[Array,Number]},prefixCls:String,strokeColor:{type:[Object,String,Array]},strokeLinecap:{type:String},strokeWidth:Number,trailColor:String,trailWidth:Number,transition:String},{percent:0,prefixCls:"vc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1}),setup(l){Ve+=1;const r=e(Ve),o=v((()=>Be(l.percent))),s=v((()=>Be(l.strokeColor))),[n,i]=(()=>{const a=e(new Map);return t((()=>{a.value=new Map})),[e=>t=>{a.value.set(e,t)},a]})();(t=>{const a=e(null);y((()=>{const e=Date.now();let l=!1;t.value.forEach((t=>{const r=(null==t?void 0:t.$el)||t;if(!r)return;l=!0;const o=r.style;o.transitionDuration=".3s, .3s, .3s, .06s",a.value&&e-a.value<100&&(o.transitionDuration="0s, 0s")})),l&&(a.value=Date.now())}))})(i);const c=()=>{const{prefixCls:e,strokeWidth:t,strokeLinecap:i,gapDegree:c,gapPosition:u}=l;let d=0;return o.value.map(((l,o)=>{const p=s.value[o]||s.value[s.value.length-1],v="[object Object]"===Object.prototype.toString.call(p)?`url(#${e}-gradient-${r.value})`:"",{pathString:g,pathStyle:m}=Xe(d,l,p,t,c,u);d+=l;const y={key:o,d:g,stroke:v,"stroke-linecap":i,"stroke-width":t,opacity:0===l?0:1,"fill-opacity":"0",class:`${e}-circle-path`,style:m};return a("path",f({ref:n(o)},y),null)}))};return()=>{const{prefixCls:e,strokeWidth:t,trailWidth:o,gapDegree:n,gapPosition:i,trailColor:u,strokeLinecap:d,strokeColor:p}=l,v=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(l=Object.getOwnPropertySymbols(e);r<l.length;r++)t.indexOf(l[r])<0&&Object.prototype.propertyIsEnumerable.call(e,l[r])&&(a[l[r]]=e[l[r]])}return a}(l,["prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","strokeColor"]),{pathString:g,pathStyle:m}=Xe(0,100,u,t,n,i);delete v.percent;const y=s.value.find((e=>"[object Object]"===Object.prototype.toString.call(e))),h={d:g,stroke:u,"stroke-linecap":d,"stroke-width":o||t,"fill-opacity":"0",class:`${e}-circle-trail`,style:m};return a("svg",f({class:`${e}-circle`,viewBox:"0 0 100 100"},v),[y&&a("defs",null,[a("linearGradient",{id:`${e}-gradient-${r.value}`,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[Object.keys(y).sort(((e,t)=>qe(e)-qe(t))).map(((e,t)=>a("stop",{key:t,offset:e,"stop-color":y[e]},null)))])]),a("path",h,null),c().reverse()])}}}),Qe=p({compatConfig:{MODE:3},name:"ProgressCircle",inheritAttrs:!1,props:h(g(g({},Te()),{strokeColor:n()}),{trailColor:null}),setup(e,t){let{slots:l,attrs:r}=t;const o=v((()=>{var t;return null!==(t=e.width)&&void 0!==t?t:120})),s=v((()=>{var t;return null!==(t=e.size)&&void 0!==t?t:[o.value,o.value]})),n=v((()=>We(s.value,"circle"))),i=v((()=>e.gapDegree||0===e.gapDegree?e.gapDegree:"dashboard"===e.type?75:void 0)),c=v((()=>({width:`${n.value.width}px`,height:`${n.value.height}px`,fontSize:.15*n.value.width+6+"px"}))),u=v((()=>{var t;return null!==(t=e.strokeWidth)&&void 0!==t?t:Math.max(3/n.value.width*100,6)})),p=v((()=>e.gapPosition||"dashboard"===e.type&&"bottom"||void 0)),g=v((()=>function(e){let{percent:t,success:a,successPercent:l}=e;const r=Pe(Me({success:a,successPercent:l}));return[r,Pe(Pe(t)-r)]}(e))),y=v((()=>"[object Object]"===Object.prototype.toString.call(e.strokeColor))),h=v((()=>function(e){let{success:t={},strokeColor:a}=e;const{strokeColor:l}=t;return[l||d.green,a||null]}({success:e.success,strokeColor:e.strokeColor}))),k=v((()=>({[`${e.prefixCls}-inner`]:!0,[`${e.prefixCls}-circle-gradient`]:y.value})));return()=>{var t;const o=a(Ke,{percent:g.value,strokeWidth:u.value,trailWidth:u.value,strokeColor:h.value,strokeLinecap:e.strokeLinecap,trailColor:e.trailColor,prefixCls:e.prefixCls,gapDegree:i.value,gapPosition:p.value},null);return a("div",f(f({},r),{},{class:[k.value,r.class],style:[r.style,c.value]}),[n.value.width<=20?a(be,null,{default:()=>[a("span",null,[o])],title:l.default}):a(m,null,[o,null===(t=l.default)||void 0===t?void 0:t.call(l)])])}}}),Ze=p({compatConfig:{MODE:3},name:"Steps",props:g(g({},Te()),{steps:Number,strokeColor:c(),trailColor:String}),setup(e,t){let{slots:l}=t;const r=v((()=>Math.round(e.steps*((e.percent||0)/100)))),o=v((()=>{var t;return null!==(t=e.size)&&void 0!==t?t:["small"===e.size?2:14,e.strokeWidth||8]})),s=v((()=>We(o.value,"step",{steps:e.steps,strokeWidth:e.strokeWidth||8}))),n=v((()=>{const{steps:t,strokeColor:l,trailColor:o,prefixCls:n}=e,i=[];for(let e=0;e<t;e+=1){const c=Array.isArray(l)?l[e]:l,u={[`${n}-steps-item`]:!0,[`${n}-steps-item-active`]:e<=r.value-1};i.push(a("div",{key:e,class:u,style:{backgroundColor:e<=r.value-1?c:o,width:s.value.width/t+"px",height:`${s.value.height}px`}},null))}return i}));return()=>{var t;return a("div",{class:`${e.prefixCls}-steps-outer`},[n.value,null===(t=l.default)||void 0===t?void 0:t.call(l)])}}}),He=new w("antProgressActive",{"0%":{transform:"translateX(-100%) scaleX(0)",opacity:.1},"20%":{transform:"translateX(-100%) scaleX(0)",opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}}),Je=e=>{const{componentCls:t,iconCls:a}=e;return{[t]:g(g({},C(e)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:e.fontSize,marginInlineEnd:e.marginXS,marginBottom:e.marginXS},[`${t}-outer`]:{display:"inline-block",width:"100%"},[`&${t}-show-info`]:{[`${t}-outer`]:{marginInlineEnd:`calc(-2em - ${e.marginXS}px)`,paddingInlineEnd:`calc(2em + ${e.paddingXS}px)`}},[`${t}-inner`]:{position:"relative",display:"inline-block",width:"100%",overflow:"hidden",verticalAlign:"middle",backgroundColor:e.progressRemainingColor,borderRadius:e.progressLineRadius},[`${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorInfo}},[`${t}-success-bg, ${t}-bg`]:{position:"relative",backgroundColor:e.colorInfo,borderRadius:e.progressLineRadius,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`},[`${t}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:e.colorSuccess},[`${t}-text`]:{display:"inline-block",width:"2em",marginInlineStart:e.marginXS,color:e.progressInfoTextColor,lineHeight:1,whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[a]:{fontSize:e.fontSize}},[`&${t}-status-active`]:{[`${t}-bg::before`]:{position:"absolute",inset:0,backgroundColor:e.colorBgContainer,borderRadius:e.progressLineRadius,opacity:0,animationName:He,animationDuration:e.progressActiveMotionDuration,animationTimingFunction:e.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${t}-status-exception`]:{[`${t}-bg`]:{backgroundColor:e.colorError},[`${t}-text`]:{color:e.colorError}},[`&${t}-status-exception ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorError}},[`&${t}-status-success`]:{[`${t}-bg`]:{backgroundColor:e.colorSuccess},[`${t}-text`]:{color:e.colorSuccess}},[`&${t}-status-success ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorSuccess}}})}},Ye=e=>{const{componentCls:t,iconCls:a}=e;return{[t]:{[`${t}-circle-trail`]:{stroke:e.progressRemainingColor},[`&${t}-circle ${t}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${t}-circle ${t}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:e.colorText,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[a]:{fontSize:e.fontSize/e.fontSizeSM+"em"}},[`${t}-circle&-status-exception`]:{[`${t}-text`]:{color:e.colorError}},[`${t}-circle&-status-success`]:{[`${t}-text`]:{color:e.colorSuccess}}},[`${t}-inline-circle`]:{lineHeight:1,[`${t}-inner`]:{verticalAlign:"bottom"}}}},Ge=e=>{const{componentCls:t}=e;return{[t]:{[`${t}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:e.progressStepMinWidth,marginInlineEnd:e.progressStepMarginInlineEnd,backgroundColor:e.progressRemainingColor,transition:`all ${e.motionDurationSlow}`,"&-active":{backgroundColor:e.colorInfo}}}}}},et=e=>{const{componentCls:t,iconCls:a}=e;return{[t]:{[`${t}-small&-line, ${t}-small&-line ${t}-text ${a}`]:{fontSize:e.fontSizeSM}}}},tt=k("Progress",(e=>{const t=e.marginXXS/2,a=b(e,{progressLineRadius:100,progressInfoTextColor:e.colorText,progressDefaultColor:e.colorInfo,progressRemainingColor:e.colorFillSecondary,progressStepMarginInlineEnd:t,progressStepMinWidth:t,progressActiveMotionDuration:"2.4s"});return[Je(a),Ye(a),Ge(a),et(a)]}));const at=I(p({compatConfig:{MODE:3},name:"AProgress",inheritAttrs:!1,props:h(Te(),{type:"line",percent:0,showInfo:!0,trailColor:null,size:"default",strokeLinecap:"round"}),slots:Object,setup(e,t){let{slots:l,attrs:r}=t;const{prefixCls:o,direction:s}=x("progress",e),[n,i]=tt(o),c=v((()=>Array.isArray(e.strokeColor)?e.strokeColor[0]:e.strokeColor)),u=v((()=>{const{percent:t=0}=e,a=Me(e);return parseInt(void 0!==a?a.toString():t.toString(),10)})),d=v((()=>{const{status:t}=e;return!Le.includes(t)&&u.value>=100?"success":t||"normal"})),p=v((()=>{const{type:t,showInfo:a,size:l}=e,r=o.value;return{[r]:!0,[`${r}-inline-circle`]:"circle"===t&&We(l,"circle").width<=20,[`${r}-${"dashboard"===t?"circle":t}`]:!0,[`${r}-status-${d.value}`]:!0,[`${r}-show-info`]:a,[`${r}-${l}`]:l,[`${r}-rtl`]:"rtl"===s.value,[i.value]:!0}})),g=v((()=>"string"==typeof e.strokeColor||Array.isArray(e.strokeColor)?e.strokeColor:void 0));return()=>{const{type:t,steps:i,title:u}=e,{class:v}=r,m=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(l=Object.getOwnPropertySymbols(e);r<l.length;r++)t.indexOf(l[r])<0&&Object.prototype.propertyIsEnumerable.call(e,l[r])&&(a[l[r]]=e[l[r]])}return a}(r,["class"]),y=(()=>{const{showInfo:t,format:r,type:s,percent:n,title:i}=e,c=Me(e);if(!t)return null;let u;const p=r||(null==l?void 0:l.format)||(e=>`${e}%`),v="line"===s;return r||(null==l?void 0:l.format)||"exception"!==d.value&&"success"!==d.value?u=p(Pe(n),Pe(c)):"exception"===d.value?u=a(v?S:A,null,null):"success"===d.value&&(u=a(v?$:ke,null,null)),a("span",{class:`${o.value}-text`,title:void 0===i&&"string"==typeof u?u:void 0},[u])})();let h;return"line"===t?h=i?a(Ze,f(f({},e),{},{strokeColor:g.value,prefixCls:o.value,steps:i}),{default:()=>[y]}):a(Ue,f(f({},e),{},{strokeColor:c.value,prefixCls:o.value,direction:s.value}),{default:()=>[y]}):"circle"!==t&&"dashboard"!==t||(h=a(Qe,f(f({},e),{},{prefixCls:o.value,strokeColor:c.value,progressStatus:d.value}),{default:()=>[y]})),n(a("div",f(f({role:"progressbar"},m),{},{class:[p.value,v],title:u}),[h]))}}}));var lt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};function rt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),l.forEach((function(t){ot(e,t,a[t])}))}return e}function ot(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var st=function(e,t){var r=rt({},e,t.attrs);return a(l,rt({},r,{icon:lt}),null)};st.displayName="MinusCircleOutlined",st.inheritAttrs=!1;var nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};function it(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),l.forEach((function(t){ct(e,t,a[t])}))}return e}function ct(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ut=function(e,t){var r=it({},e,t.attrs);return a(l,it({},r,{icon:nt}),null)};ut.displayName="PlusCircleOutlined",ut.inheritAttrs=!1;const dt=O("useChunkView",(()=>({showChunkModel:e(!1)}))),pt=E(p({__name:"LoadingImg",setup(t){const a=e();return _((()=>{a.value&&a.value.classList.add("loading")})),j((()=>{a.value&&a.value.classList.remove("loading")})),(e,t)=>(z(),D("img",{ref_key:"loadingRef",ref:a,class:"img",src:pe,alt:"loading"},null,512))}}),[["__scopeId","data-v-e69df7ef"]]),vt={key:0,class:"container"},gt={class:"title"},ft={class:"multi-color-progress"},mt={class:"progress-outer"},yt={class:"progress"},ht={class:"percent"},kt={class:"percent-text"},bt=E(p({__name:"UploadProgress",setup(t){const{dataSource:l,totalStatus:r,kbTotal:o}=F(ve()),s=he().progress,n=e({green:0,yellow:0,red:0,gray:0}),i=e({green:0,yellow:0,red:0,gray:0}),c=e({green:0,yellow:0,red:0,gray:0});return N((()=>r),(()=>{(()=>{n.value=r.value;for(const t in n.value){const e=n.value[t]/o.value*100;i.value[t]=parseFloat(e.toFixed(2))}const e=100-Object.values(i.value).reduce(((e,t)=>e+t),0);e>0&&(i.value.gray+=e),c.value.green=i.value.green,c.value.red=i.value.red+c.value.green,c.value.yellow=i.value.yellow+c.value.red,c.value.gray=i.value.gray+c.value.yellow})()}),{immediate:!0,deep:!0}),(e,t)=>{const r=at,o=be;return 0!==L(l).length?(z(),D("div",vt,[T("span",gt,P(L(s).uploadTotalProgress)+"：",1),a(o,{title:`${L(s).putStorage}: ${L(n).green},\n      ${L(s).inLine}: ${L(n).gray},\n      ${L(s).parsing}: ${L(n).yellow},\n      ${L(s).failure}: ${L(n).red}`},{default:M((()=>[T("div",ft,[T("div",mt,[T("div",yt,[a(r,{percent:L(c).green,class:"progress-segment green",status:"active","stroke-color":"#52c41a"},null,8,["percent"]),a(r,{percent:L(c).red,class:"progress-segment red",status:"active","stroke-color":"#f5222d"},null,8,["percent"]),a(r,{percent:L(c).yellow,class:"progress-segment yellow",status:"active","stroke-color":"#FFEB3B"},null,8,["percent"]),a(r,{percent:L(c).gray,class:"progress-segment gray",status:"active","stroke-color":"#bfbfbf"},null,8,["percent"])])]),T("div",ht,[T("div",kt,P((L(i).green+L(i).red).toFixed(2))+"% ",1)])])])),_:1},8,["title"])])):W("",!0)}}}),[["__scopeId","data-v-742741e5"]]),Ct={class:"container"},wt={class:"scale"},xt={class:"scale-text"},St={class:"file-preview-content"},At=(e=>(J("data-v-31e87df2"),e=e(),Y(),e))((()=>T("div",{class:"resize-handle"},null,-1))),$t={class:"export"},It={style:{color:"#666","user-select":"text"}},Ot={class:"file-path"},_t={key:1},jt=["innerHTML"],zt={key:2,class:"editable-row-operations"},Dt={key:0,class:"operation-div"},Et={class:"footer"},Ft=E(p({__name:"ChunkViewDialog",props:{kbId:{},fileId:{},fileName:{}},setup(t){const{showChunkModel:l}=F(dt()),{common:r}=he(),{chatSettingFormActive:o}=F(Ce()),{setSourceType:s,setSourceUrl:n,setTextContent:i}=we(),c=t,{kbId:u,fileId:d,fileName:p}=R(c),v=e([{title:"编号",key:"id",dataIndex:"id",width:70},{title:"markdown预览",key:"content",dataIndex:"content",resizable:!0,width:150,minWidth:150},{title:"分析结果",key:"editContent",dataIndex:"editContent",resizable:!0,width:150,minWidth:150},{title:"操作",key:"operation",dataIndex:"operation",width:100}]),g=e(new Map),f=e=>{const t=e.key,a=e.content;g.value.has(t)?g.value.delete(t):g.value.set(t,a)},m=(...e)=>{e[2].map((e=>{const t=e.key,a=e.content;g.value.has(t)?g.value.delete(t):g.value.set(t,a)}))},y=()=>{let e="";[...g.value.values()].map((t=>{e+=t+"\n\n"})),h(e)},h=e=>{try{const t="output.txt",a=new File([e],t,{type:"text/plain;charset=utf-8"}),l=URL.createObjectURL(a);ce(l,t),g.value.clear()}catch(t){U.error("download error")}},k=e(!1),b=e(!1),C=e({pageNum:1,pageSize:5,total:0,showSizeChanger:!1,showTotal:e=>`共 ${e} 条`}),w=e=>{C.value.pageNum=e.current,E(u.value,d.value)},x=e([]),S=e({}),A=e(1),$=e(""),I=()=>{l.value=!1,!b&&(S.value={})},O=e(1),_=()=>{O.value+=.1},j=()=>{O.value<=.15||(O.value-=.1)},E=async(e,t)=>{k.value=!0;try{const a=await ne(await ie.getDocCompleted({kb_id:e,file_id:t,page_id:C.value.pageNum,page_limit:C.value.pageSize}));A.value=(C.value.pageNum-1)*C.value.pageSize+1,C.value.total=a.total_count,x.value=[],$.value=a.file_path,a.chunks.forEach((e=>{x.value.push({key:e.chunk_id,id:A.value++,content:e.page_content,editContent:e.page_content})}))}catch(a){U.error(a.msg||"获取文档解析结果失败")}finally{k.value=!1}};N((()=>l.value),(()=>{l.value?(x.value=[],E(u.value,d.value),Y({file_id:d.value,file_name:p.value})):l.value||(O.value=1,x.value=[],A.value=1,C.value.pageNum=1,C.value.total=1,n(""),i(""),g.value.clear())}));let J=["pdf","docx","xlsx","txt","md","jpg","png","jpeg","csv","eml"];const Y=e=>{(e=>{if(!e)return!1;const t=e.split(".");if(t.length){const e=t.pop();return!!J.includes(e)}return!1})(e.file_name)&&async function(e){try{n(null);const t=await ne(await ie.getFile({file_id:e.file_id})),a=e.file_name.split(".").pop(),l=function(e){const t=J.indexOf(e);return G[t]}(a);if(s(a),n(`data:${l};base64,${t.file_base64}`),"txt"===a||"md"===a||"csv"===a||"eml"===a){const e=atob(t.file_base64),a=decodeURIComponent(escape(e));i(a)}}catch(t){U.error(t.msg||"获取文件失败")}}(e)};let G=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/markdown","image/jpeg","image/png","image/jpeg","text/csv","message/rfc822","application/vnd.openxmlformats-officedocument.presentationml.presentation"];const ee=e(null),te=e(0),ae=(e,t)=>{te.value=ee.value.clientWidth;const a=e<t.width?"left":"right";(document.querySelector(".chunk-table").querySelector('.ant-table-cell[colstart="3"]').clientWidth>150||"left"===a)&&(t.width=e)},le=e(!1),re=e(0),oe=e(0),se=e("40%"),ue=e=>{e.target.classList.contains("resize-handle")&&(le.value=!0,re.value=e.clientX,oe.value=e.target.parentElement.offsetWidth,window.addEventListener("mousemove",de),window.addEventListener("mouseup",pe))},de=e=>{if(le.value){const t=e.clientX-re.value;(e=>{e>=300&&(se.value=`${e}px`)})(oe.value+t)}},pe=()=>{le.value&&(le.value=!1,window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",pe))};return(e,t)=>{const s=Z,n=be,i=je,c=$e,u=Ie,d=Se,p=H;return z(),V(Q,{to:"body"},[a(p,{theme:{token:{colorPrimary:"#5a47e5"}}},{default:M((()=>[a(d,{open:L(l),"onUpdate:open":t[0]||(t[0]=e=>q(l)?l.value=e:null),title:"切片分析结果",centered:"",width:"100%","wrap-class-name":"chunk-modal","destroy-on-close":"",footer:null,onCancel:I},{default:M((()=>[T("div",Ct,[T("div",{class:"file-preview",style:B({width:L(se)}),onMousedown:ue},[T("div",wt,[a(s,{shape:"circle",icon:X(L(ut)),onClick:_},null,8,["icon"]),T("span",xt,P((100*L(O)).toFixed(0))+"%",1),a(s,{shape:"circle",icon:X(L(st)),onClick:j},null,8,["icon"])]),T("div",St,[a(Ae,{"zoom-level":L(O)},null,8,["zoom-level"])]),At],36),T("div",{ref_key:"tableDomRef",ref:ee,class:"chunk-table"},[T("div",$t,[a(n,{color:"#fff",placement:"bottom"},{title:M((()=>[T("span",It,P(L($)),1)])),default:M((()=>[T("span",Ot,"文件与解析结果所在目录: "+P(L($)),1)])),_:1}),a(s,{type:"primary",onClick:y},{default:M((()=>[K(" 导出选中("+P(L(g).size)+") ",1)])),_:1})]),a(u,{columns:L(v),"data-source":L(x),bordered:"",scroll:{y:"calc(100vh - 32px - 40px - 42px - 64px - 56px - 42px - 48px)"},pagination:L(C),loading:L(k),"row-selection":{selectedRowKeys:[...L(g).keys()],onSelect:f,onSelectAll:m},onChange:w,onResizeColumn:ae},{bodyCell:M((({column:e,record:t})=>{return["content"===e.dataIndex?(z(),V(xe,{key:0,content:L(S)[t.key]?L(S)[t.key].editContent:t.content},null,8,["content"])):W("",!0),"editContent"===e.dataIndex?(z(),D("div",_t,[L(S)[t.key]?(z(),V(i,{key:0,value:L(S)[t.key][e.dataIndex],"onUpdate:value":a=>L(S)[t.key][e.dataIndex]=a,style:{margin:"-5px 0"},"show-count":"","auto-size":""},null,8,["value","onUpdate:value"])):(z(),D("div",{key:1,innerHTML:(l=t.content,l.replace(/\n/g,"<br />"))},null,8,jt))])):"operation"===e.dataIndex?(z(),D("div",zt,[L(S)[t.key]?(z(),D("div",Dt,[a(s,{class:"operation-btn",size:"small",loading:L(b),type:"link",onClick:e=>(async e=>{b.value=!0,U.warn("正在更新……");try{await ne(await ie.updateDocCompleted({chunk_size:o.value.chunkSize,doc_id:e,update_content:S.value[e].editContent})),U.success("修改成功"),S.value[e].content=S.value[e].editContent,Object.assign(x.value.filter((t=>e===t.key))[0],S.value[e]),delete S.value[e]}catch(t){U.error(t.msg)}finally{b.value=!1}})(t.key)},{default:M((()=>[K(P(L(b)?"":L(r).save),1)])),_:2},1032,["loading","onClick"]),L(b)?W("",!0):(z(),V(s,{key:0,class:"operation-btn",size:"small",loading:L(b),type:"text",onClick:e=>{return a=t.key,void delete S.value[a];var a}},{default:M((()=>[K(P(L(r).cancel),1)])),_:2},1032,["loading","onClick"]))])):(z(),V(c,{key:1,onClick:e=>{return a=t.key,void(S.value[a]=JSON.parse(JSON.stringify(x.value.filter((e=>a===e.key))[0])));var a}},{default:M((()=>[K(P(L(r).edit),1)])),_:2},1032,["onClick"]))])):W("",!0)];var l})),_:1},8,["columns","data-source","scroll","pagination","loading","row-selection"])],512)]),T("div",Et,[a(s,{type:"primary",onClick:I},{default:M((()=>[K(P(L(r).close),1)])),_:1})])])),_:1},8,["open"])])),_:1})])}}}),[["__scopeId","data-v-31e87df2"]]),Nt={class:"file"},Lt={class:"box"},Tt={class:"before-upload-box"},Pt=["accept"],Mt={class:"before-upload"},Wt={class:"upload-text-box"},Rt={class:"upload-text"},Ut={class:"blue"},Vt={class:"desc"},qt=E(p({__name:"FileUploadDialog",props:{dialogType:{type:Number,require:!0,default:0}},setup(t){const l=he().common,{setKnowledgeName:r,setModalVisible:o}=ge(),{setDefault:s}=fe(),{getDetails:n}=ve(),{modalVisible:i,modalTitle:c}=F(ge()),{currentId:u,currentKbName:d}=F(fe()),{uploadFileList:p,uploadFileListQuick:g}=F(me()),{initUploadFileList:f}=me(),{chatSettingFormActive:m}=F(Ce()),y=t,h=e(),k=v((()=>u.value.length>0&&p.value.length>0&&p.value.every((e=>"loading"!=e.status))));N((()=>i.value),(()=>{r(d.value),1===y.dialogType&&(p.value=g.value),i.value||0!==y.dialogType||f()}));const b=[".md",".txt",".pdf",".jpg",".png",".jpeg",".docx",".xlsx",".pptx",".eml",".csv"],C={document:31457280,image:5242880},w=e=>{const t=e.target.files;let a=0;Array.from(t).forEach((e=>{a+=e.size,a>=131072e3&&U.error("文件总大小超过125MB")})),Array.from(t).forEach((async(e,t)=>{try{await(async(e,t)=>new Promise(((a,r)=>{if(e.name&&b.includes("."+e.name.split(".").pop().toLowerCase())){const o=e.type.startsWith("image/")?C.image:C.document,s=e.type.startsWith("image/")?"图片":"文档";if(e.size>o)return void r(`单个${s}太大，不能超过 ${o/1024/1024} MB`);p.value.push({file_name:e.name,file:e,status:"loading",text:l.uploading,file_id:"",order:p.value.length,bytes:0}),a(t)}else r(`${e.name}的文件格式不符`)})))(e,t)}catch(a){U.error(a)}})),setTimeout((()=>{p.value.length&&x()}))},x=async()=>{var e;$();const t=[];p.value.forEach((e=>{"loading"==e.status&&t.push(e)}));const a=new FormData;for(let l=0;l<t.length;l++)a.append("files",null==(e=t[l])?void 0:e.file);a.append("kb_id",u.value),a.append("user_id",ue),a.append("chunk_size",m.value.chunkSize.toString()),a.append("mode","soft"),S(0),fetch(de+"/local_doc_qa/upload_files",{method:"POST",body:a}).then((e=>{if(e.ok)return e.json();throw new Error("上传失败")})).then((e=>{if(200===e.code){if(0===e.data.length)return U.warn(e.msg||"出错了"),te.close("upload"),void(1===y.dialogType&&t.forEach((t=>{p.value[t.order].status="error",p.value[t.order].errorText=(null==e?void 0:e.msg)||l.upFailed})));S(1),1===y.dialogType&&t.forEach(((t,a)=>{let r=e.data[a].status;r="green"==r||"gray"==r?"success":"error",p.value[t.order].status=r,p.value[t.order].file_id=e.data[a].file_id,p.value[t.order].bytes=e.data[a].bytes,p.value[t.order].errorText=l.upSucceeded}))}else U.error(e.msg||"出错了"),te.close("upload"),t.forEach((t=>{p.value[t.order].status="error",p.value[t.order].errorText=(null==e?void 0:e.msg)||l.upFailed}))})).catch((e=>{U.error(e.msg||"出错了"),te.close("upload")})).finally((()=>{n()}))},S=e=>{te[e?"success":"info"]({key:"upload",message:e?"上传完成":"上传中",description:e?"":"最多需要30s",duration:e?2.5:0})},A=async()=>{o(!1),s(ye.optionlist),await n()},$=()=>{o(!1)};return G((()=>{h.value&&clearTimeout(h.value)})),(e,t)=>{const r=Z,o=Se;return z(),V(Q,{to:"body"},[a(o,{open:L(i),"onUpdate:open":t[1]||(t[1]=e=>q(i)?i.value=e:null),title:L(c),centered:"",width:"480px","wrap-class-name":"upload-file-modal","destroy-on-close":""},{footer:M((()=>[0===y.dialogType?(z(),V(r,{key:"submit",type:"primary",class:"upload-btn",disabled:!L(k),onClick:A},{default:M((()=>[K(P(L(l).confirm),1)])),_:1},8,["disabled"])):W("",!0),1===y.dialogType?(z(),V(r,{key:"submit",type:"primary",class:"upload-btn",onClick:$},{default:M((()=>[K(P(L(l).cancel),1)])),_:1})):W("",!0)])),default:M((()=>[T("div",Nt,[T("div",Lt,[T("div",Tt,[T("input",{class:"hide input",type:"file",accept:b.join(","),multiple:"",onChange:w,onClick:t[0]||(t[0]=e=>e.target.value="")},null,40,Pt),T("div",Mt,[T("div",Wt,[a(ee,{name:"upload"}),T("p",null,[T("span",Rt,[K(P(L(l).dragUrl)+" ",1),T("span",Ut,P(L(l).click),1)])])]),T("p",Vt,P(L(l).updesc1),1)])])])])])),_:1},8,["open","title"])])}}}),[["__scopeId","data-v-14f8a744"]]),Bt=e=>(J("data-v-e59e1d91"),e=e(),Y(),e),Xt={class:"list-page"},Kt={class:"content"},Qt={class:"options"},Zt=Bt((()=>T("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAKFSURBVFiF1ZjNattAEIC/VH0Ag3O3wb0b+gKF0HMCfoAW/AAFP0ALaZ8guffQvoFzzsF5hNwLUu4F+Q2mB+1Yk9XfriTXycAiWdbufDuz2p2ZMxFJeMHy5tQAXfJ2YP8J8AGYufuZe/4E7N31wd3/N8AJ8Am4Apbud5dsgTvgV6yys8g1+AX4ZqD2wKNrajEoLbqksLBKBvyIAhWRJKC9F5FUStmJyEpEpgF9p+7dnemfisgiRHcI4FpEcgN2ETipprF0orkDHwR4bWZ9MwDMbzdm3Ou+gCszyGZEuLrJr2MBF1K6tXWGA9vG6cilWOfBgKnrOKZbu9ydhgKu2zoEtoWzTshXnkj5hVeWUh2gWq9xXQTA6Riha/fCvZ/7k/IB1Xq7EeDSCAs2WtEPFi7d9Tb8cDnIHLh31wz4SNwZrDqv7EN71E2Av+7+PHLwOrgsor/q/+Pu36l+a0E9M2OjjzHgoDzXNULCB9RQ6fEEcCqq+xAhWUAboZwCzupWY9Va8Ikw+cm4cFZ3LWCszLpfGS4WsELfIWq1OaWrh0rFixZQ/R8SwsNz184ZB7LyHdRZcBkxYMa4kKr7YEF/o65slIFi4TL6b9SVg8J3cWWjDBQLZWFjRHVuaXCx/glF9hYrGcMgVefds6deRDGVMpLumxz1CbcaY9C6eFDD8L4hl040JmDVCVVi0FcZ8idSJDDq6mNkdNo0s8ulIZFvSzt1XYgcJ7PbmPEbE/hXnbhrW0np7lT6J1OJFDuD5h55yFihxaOFjF88qk3U/RZbfvsMfPU24Afay2+2hrgHvhORlMUCWtBLvAysQfQI3QK/iay29gVUaSsBaxl4UAl4KODR5cVX+f8BBZDb8KKHVtYAAAAASUVORK5CYII=",alt:"back"},null,-1))),Ht={class:"kb-name"},Jt={class:"name"},Yt={class:"id"},Gt={class:"nav-info"},ea={class:"navs"},ta=["onClick"],aa={key:0,class:"nav-progress"},la={class:"handle-btn"},ra={class:"table"},oa=Bt((()=>T("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAP5JREFUOE+tlNENgzAMRM1khY28QcsG3qgwWauz4ujiJKBKzRcY5+U421nkT2uZcVR1FZEnfT/xbGav0Z4ONADsIgIo1qM87xnYgFQVp0FFlxgqZjkVRAmbmR3YSDG8Ax5xKHyLSM1l0IeV0C/CGwCwsSothzzMbMOhDsrBEouNrK4xW1VrDoNy0hq/QmDkuIIcCxDI56y0I8UF5C0COIOqmdwn4RUrSRV0nxjUyB4l50YsSt2SAFWJk+SD/UoeuSVc/kufJgfAH2cwqGsyqkxTiOJb01e3I1I2oRV8WG9HZDBLaESf+NLZfBN0Fb66RuK6wMTHGrZI41E289f3L/XxvhPPyll2AAAAAElFTkSuQmCC",style:{width:"18px","margin-left":"5px"},alt:"©"},null,-1))),sa={style:{color:"#666","user-select":"text"}},na={key:2,class:"status-box"},ia={class:"icon-file-status"},ca={key:0},ua={key:1},da={key:0,class:"status-box"},pa={class:"icon-file-status"},va={key:1,class:"options"},ga=E(p({__name:"OptionList",setup(t){const{setDefault:l}=fe(),{currentKbName:r,currentId:o}=F(fe()),{setModalVisible:s,setUrlModalVisible:n,setModalTitle:i}=ge(),{showChunkModel:c}=F(dt()),{getDetails:u,setEditQaSet:d,setEditModalVisible:p,getFaqList:g,setFaqType:f,setPageNum:y,setKbPageNum:h}=ve(),{dataSource:k,faqList:b,timer:C,faqTimer:w,total:x,pageNum:S,pageSize:A,loading:$,kbTotal:I,kbPageNum:O,kbPageSize:_}=F(ve()),j=he().home,E=he().common,R=he().bots,q=e(0),B=[{name:j.docSet,value:0},{name:j.qaSet,value:1}],Q=[{title:j.documentId,dataIndex:"fileId",key:"fileId",width:"11%"},{title:j.documentName,dataIndex:"fileIdName",key:"fileIdName",width:"10%",ellipsis:!0},{title:j.documentStatus,dataIndex:"status",key:"status",width:"15%",ellipsis:!0},{title:j.fileSize,dataIndex:"bytes",key:"bytes",width:"10%"},{title:j.contentLength,dataIndex:"contentLength",key:"contentLength",width:"10%"},{title:j.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:j.remark,dataIndex:"remark",key:"remark",width:"15%"},{title:j.operate,key:"options",width:"10%"}],H=[{title:"ID",dataIndex:"id",key:"id",width:"8%"},{title:j.question,dataIndex:"question",key:"question",width:"43%",ellipsis:!0},{title:j.status,dataIndex:"status",key:"status",width:"10%",ellipsis:!0},{title:j.characterCount,dataIndex:"bytes",key:"bytes",width:"10%"},{title:j.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:j.operate,key:"options",width:"10%"}],J=e({}),Y=["pink","orange","green","cyan","blue","purple"],te=e=>Y[e%Y.length],ce=e(),ue=e=>{const t=e.fileId,a=J.value[t].inputValue.split(","),l=k.value.find((e=>e.fileId===t)).fileTag;a.length&&a.forEach((e=>{e&&-1===l.indexOf(e)&&l.push(e)})),Object.assign(J.value[t],{isInput:!1,inputValue:""})};ae((()=>{k.value.forEach((e=>{e.fileTag=["1","2","3"],J.value[e.fileId]={isInput:!1,inputValue:""}}))}));const de=v((()=>({current:O.value,pageSize:_.value,total:I.value,showSizeChanger:!1,showTotal:e=>`共 ${e} 条`}))),pe=v((()=>({current:S.value,pageSize:A.value,total:x.value,showSizeChanger:!1,showTotal:e=>`共 ${e} 条`})));let me={};const ke=e(""),Ce=e(""),we=async()=>{try{await ne(await ie.deleteFile({file_ids:[me.fileId],kb_id:o.value})),U.success("删除成功"),await u(),1!==O.value&&0===k.value.length&&(O.value-=1,await u())}catch(e){U.error(e.msg||"删除失败")}};let xe={};const Ae=async()=>{try{await ne(await ie.deleteFile({kb_id:`${o.value}_FAQ`,file_ids:[xe.faqId]})),U.success("删除成功"),await g(),1!==S.value&&0===b.value.length&&(S.value-=1,await g())}catch(e){U.error(e.msg||"删除失败")}},$e=()=>{l(ye.normal)},je=()=>{s(!0),i(j.upload)},De=()=>{n(!0),i(E.addUrl)},Ee=()=>{f("upload"),p(!0)},Fe=()=>{Se.confirm({title:j.clearAllFile,content:X("p",j.clearAllFileConfirm),centered:!0,maskClosable:!0,okText:E.confirm,okType:"danger",async onOk(){try{await ne(await ie.clearUpload({status:"gray",kb_ids:[]})),U.success("操作成功"),u()}catch(e){U.error(e.msg||"操作失败")}}})},Le=e=>{let t;switch(e){case"gray":t=E.inLine;break;case"yellow":t=E.parsing;break;case"green":t=E.succeeded;break;default:t=E.failed}return t},Te=e=>{let t=E.failed;switch(e){case"gray":t=E.uploadCompleted;break;case"yellow":t=E.inLine;break;case"green":t=E.learningCompleted}return t},Pe=async()=>{if(!(await(async()=>{try{if((await ne(await ie.kbList())).find((e=>e.kb_id===`${o.value}_FAQ`)))return!0}catch(e){return U.error(e.msg||E.error),!0}return!1})())){try{await ne(await ie.createKb({kb_name:`${r.value}_FAQ`,kb_id:`${o.value}_FAQ`}))}catch(e){return U.error(e.msg||E.error),!1}return!0}},Me=e=>{const{current:t}=e;y(t),g()},We=e=>{h(e.current),u()};return N(o,(()=>{q.value=0,h(1),y(1),u()}),{immediate:!0}),G((()=>{clearTimeout(C.value),clearTimeout(w.value),h(1),y(1)})),(e,t)=>{const l=Z,s=be,n=Oe,i=ze,v=ee,x=_e,S=Ie;return z(),D(m,null,[T("div",Xt,[T("div",Kt,[T("div",Qt,[T("div",{class:"to-chat",onClick:$e},[Zt,T("span",null,P(L(j).conversation),1)]),T("p",Ht,[T("span",Jt,P(L(r).slice(0,15)),1),T("span",Yt,P(L(j).knowledgeID)+" "+P(L(o))+P(1===L(q)?"_FAQ":""),1)])]),T("div",Gt,[T("div",ea,[(z(),D(m,null,le(B,(e=>T("div",{key:e.name,class:re(["nav-item",L(q)===e.value?"nav-item-active":""]),onClick:t=>{return a=e.value,q.value=a,void(0===a?(h(1),clearTimeout(w.value),u()):(y(1),clearTimeout(C.value),g(),Pe()));var a}},P(e.name),11,ta))),64))]),0===L(q)?(z(),D("div",aa,[a(bt,{"data-source":L(k)},null,8,["data-source"])])):W("",!0),T("div",la,[0===L(q)?(z(),V(l,{key:0,danger:"",class:"clear-upload",onClick:Fe},{default:M((()=>[K(P(L(j).clearAllFile),1)])),_:1})):W("",!0),0===L(q)?(z(),V(l,{key:1,class:"upload",onClick:je},{default:M((()=>[K(P(L(j).upload),1)])),_:1})):W("",!0),0===L(q)?(z(),V(l,{key:2,class:"add-link",onClick:De},{default:M((()=>[K(P(L(j).addUrl),1)])),_:1})):W("",!0),1===L(q)?(z(),V(l,{key:3,class:"upload",onClick:Ee},{default:M((()=>[K(P(L(j).inputQa),1)])),_:1})):W("",!0)])]),T("div",ra,[0===L(q)?(z(),V(S,{key:0,"data-source":L(k),columns:Q,pagination:L(de),locale:{emptyText:L(j).emptyText},"hide-on-single-page":!0,"show-size-changer":!1,onChange:We},{headerCell:M((({column:e})=>["status"===e.key?(z(),D(m,{key:0},[T("span",null,P(L(j).documentStatus),1),a(s,{color:"#5a47e5"},{title:M((()=>[K(P(L(j).documentStatusNode),1)])),default:M((()=>[oa])),_:1})],64)):W("",!0)])),bodyCell:M((({column:e,record:t})=>["fileIdName"===e.key?(z(),V(s,{key:0,color:"#fff"},{title:M((()=>[T("span",sa,P(t.fileIdName),1)])),default:M((()=>[T("span",null,P(t.fileIdName),1)])),_:2},1024)):"fileTag"===e.key?(z(),D(m,{key:1},[(z(!0),D(m,null,le(t.fileTag,((e,a)=>(z(),V(n,{key:e,color:te(a),closable:0!==a,onClose:a=>((e,t)=>{const a=t.fileId;k.value.forEach((t=>{t.fileId===a&&(t.fileTag=t.fileTag.filter((t=>t!==e)))}))})(e,t)},{default:M((()=>[K(P(e),1)])),_:2},1032,["color","closable","onClose"])))),128)),L(J)[t.fileId].isInput?(z(),V(i,{key:0,ref_key:"inputRef",ref:ce,value:L(J)[t.fileId].inputValue,"onUpdate:value":e=>L(J)[t.fileId].inputValue=e,type:"text",size:"small",style:{width:"78px"},onBlur:e=>ue(t),onKeyup:oe((e=>ue(t)),["enter"])},null,8,["value","onUpdate:value","onBlur","onKeyup"])):(z(),V(n,{key:1,style:{background:"#fff","border-style":"dashed"},onClick:e=>(e=>{const t=e.fileId;J.value[t].isInput=!0,se((()=>{ce.value.focus()}))})(t)},{default:M((()=>[a(L(Ne)),K(" New Tag ")])),_:2},1032,["onClick"]))],64)):"status"===e.key?(z(),D("div",na,[T("span",ia,["gray"===t.status||"yellow"===t.status?(z(),V(pt,{key:0,class:"file-status"})):(z(),V(v,{key:1,class:"file-status",name:"green"===t.status?"success":"error"},null,8,["name"]))]),T("span",null,P(Le(t.status)),1)])):"remark"===e.key?(z(),D(m,{key:3},["string"==typeof t.remark?(z(),D("div",ca,P(t.remark),1)):(z(),D("div",ua,[(z(!0),D(m,null,le(t.remark,((e,t)=>(z(),D("p",{key:t},P(`${t}: ${e}`),1)))),128))]))],64)):"options"===e.key?(z(),D(m,{key:4},[a(x,{"overlay-class-name":"del-pop",placement:"topRight",title:L(E).deleteTitle,"ok-text":L(E).confirm,"cancel-text":L(E).cancel,onConfirm:we},{default:M((()=>[a(l,{type:"text",class:"delete-item",onClick:e=>{me=t}},{default:M((()=>[K(P(L(E).delete),1)])),_:2},1032,["onClick"])])),_:2},1032,["title","ok-text","cancel-text"]),a(l,{type:"text",class:"view-item",disabled:!("green"===t.status),onClick:e=>(async e=>{ke.value=e.fileId,Ce.value=e.fileIdName,c.value=!0})(t)},{default:M((()=>[K(P(L(E).view),1)])),_:2},1032,["disabled","onClick"])],64)):W("",!0)])),_:1},8,["data-source","pagination","locale"])):(z(),V(S,{key:1,"data-source":L(b),columns:H,locale:{emptyText:L(j).emptyText},loading:L($),pagination:L(pe),onChange:Me},{bodyCell:M((({column:e,record:t})=>["status"===e.key?(z(),D("div",da,[T("span",pa,["gray"===t.status||"yellow"===t.status?(z(),V(pt,{key:0,class:"file-status"})):(z(),V(v,{key:1,class:"file-status",name:"green"===t.status?"success":"error"},null,8,["name"]))]),T("span",null,P(Te(t.status)),1)])):"options"===e.key?(z(),D("div",va,[a(l,{class:"edit-item",type:"link",disabled:"green"!==t.status,onClick:e=>{return a=t,f("edit"),d(a),void p(!0);var a}},{default:M((()=>[K(P(L(R).edit),1)])),_:2},1032,["disabled","onClick"]),a(x,{"overlay-class-name":"qa-del-pop",placement:"topRight",title:L(j).deleteQaSetText,"ok-text":L(E).confirm,"cancel-text":L(E).cancel,onConfirm:Ae},{default:M((()=>[a(l,{class:"delete-item",danger:"",type:"link",onClick:e=>{xe=t}},{default:M((()=>[K(P(L(E).delete),1)])),_:2},1032,["onClick"])])),_:2},1032,["title","ok-text","cancel-text"])])):W("",!0)])),_:1},8,["data-source","locale","loading","pagination"]))])])]),a(Ft,{"kb-id":L(o),"file-id":L(ke),"file-name":L(Ce)},null,8,["kb-id","file-id","file-name"]),a(qt,{"dialog-type":0})],64)}}}),[["__scopeId","data-v-e59e1d91"]]);export{qt as F,pt as L,ga as O,at as _};
